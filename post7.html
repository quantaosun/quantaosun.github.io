<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Quantao's Blog - Quantao Theme</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <!-- Custom styles for this template -->
  <link href="css/clean-blog.min.css" rel="stylesheet">

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand" href="index.html">Quantao</a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">About Me</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html">Blogs</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contact.html">Contact Me</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Page Header -->
  <header class="masthead" style="background-image: url('img/post-bg.jpg')">
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="post-heading">
            <h1>自由能微扰简介</h1>
            <h2 class="subheading">理论基础扎实，逻辑清晰的自由能微扰药物设计，是目前最靠谱的方法之一，其最主要局限在于实现该理论方法的大量计算资源还无法大规模普及。 </h2>
            <span class="meta">Posted by
              <a href="#">Quantao</a>
              on November 30, 2020</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Post Content -->
  <article>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <p>由能微扰（FEP）— A short introduction in drug discovery 物理学或者物理化学中的自由能微扰由来已久，至少在二十世纪五十年代即已存在。吉布斯自由能的变化只与起始状态和最终状态有关，不管变化路径如何，始终态之间的差值是固定的，就像一条河上下游的两座城市，可以有很多条路连接，但不管这些路是水路还是先爬了一座山又下了一个坡的陆路，两座城市之间的海拔差值始终是固定的。<p/>

<p>耶鲁大学的Jorgensen教授于二十世纪八十年代首次将自由能这一纯粹的物理化学概念引入一个特殊的应用场景，即蛋白质和小分子的结合。这个应用场景之所以重要，是因为几乎所有的药物（大部分的传统药物）都是小分子，而小分子与人体的作用机理，大部分也涉及到与蛋白质的结合。当评估两个类似的小分子哪个更容易与蛋白结合的时候，人们往往是通过体外实验的方法，比如测量IC50，使用ITC测量焓变等方法。Jorgensen教授的主要贡献在于，该课题组意识到两个小分子之间的这些体外测量数据的差异，可以用它们与蛋白结合的自由能差异来解释。<p/>

<p>药物研发是长达数十年，涉及众多学科的综合项目，早期药物发现非常重要的就是评估类似药物小分子对特定蛋白质的结合能力的大小。分子对接已经被广泛应用，其最大的问题是容易给出假阳性的结果，当一个系列的小分子长得都比较类似，只是局部稍有不同的时候，FEP可以显著降低假阳性。<p/>

<p>上文已经提到吉布斯自由能只与始/终态有关，理解这一点至关重要。计算机模拟计算的吉布斯自由能虚幻的设想了一个现实中永远不会发生的路径来连接始/终态，设想现在有两个小分子， 这里用两个字母加符号表示，这两个分子有共同的母核A，第一个是Acccc(c表示A母核上带了一个侧链)，第二个是Adddd（d表示另一个侧链）<p/>

<a href="#">
            <img class="img-fluid" src="img/xlc-xld.png" alt="">
            </a>

<p>现在我们已经体外通过各种实验比如IC50测定，已经获得两个分子的相对结合能力强弱。让我们来看，自由能微扰是如何通过一个虚拟的变化路径来处理该问题. <p/>首先需要定义一个参数Lambda,λ, λ 介于0到1之间，它定义了旧侧链消失和新侧链出现的速率。 
<p>The fist λ       :Acccc > Acccd, <p/>
                  <p>Second λ lambda window Acccd > Accdd,</p> 
                  <p>Third λ Accdd > Acdddd,</p> 
                  <p>Forth λ Acddd > Adddd. </p>
<p>通过设定λ参数，比如设dλ=0.25， 就把1分为了四个窗口如上。 如果dλ=0.0625, 计算机就会按照1/0.0625=16个窗口来让c/d 消失/生长。<p/>
<p>计算机设想Acccc 首先变成了Acccd, 计算了这两个局部状态之间的自由能差值的d1 接下来，是Acccd 变成 Accdd, 再次计算这两个局部状态之间的差异 d2 以此类推： Accdd > Acddd d3, Acddd > Adddd. d4 显然这个侧链逐渐变化的过程是虚拟的，一般的自由能微扰将这个过程分为16 或者32 次，即需要分别计算16或者32个窗口的局部自由能变化，最后相加就是总的自由能变化。</p>
<p>
在现实中，这里主要是指实现这一个Acccc 到Adddd的化学反应现实，第二个分子可以由某种取代反应（或任何其他反应）一步得到第二个分子,而不是需要四步或者十六步。当lambda=0.5 的时候两个分子将以杂合体的形式存在，下图为了展示的更清楚，取代基被故意错位了一点，虚线黑色部分代表消失/未出现的原子。</p>

<a href="#">
            <img class="img-fluid" src="img/hybridized.png" alt="">
            </a>

<p>一旦你引入了假的过程，就会产生其他的不合理的逻辑需要处理。在16 或32个窗口里，产生的最大的问题是，第一个窗口和最后一个窗口， 为了简单阐述这个问题我们来看另外一个例子。 现在假设第一个分子为ccccA，第二个分子为Adddd 变化过程为，第一窗口 ccccA > cccAd 第二窗口 cccAd > ccAdd 第三窗口 ccAdd > cAddd 第四窗口 cAddd > Adddd 需要关注的是第一窗口，因为d 是第一次出现，是从无到有的突破，如果 ccccA 的旁边正好原来就已经存在的水分子w,也就是ccccAw, 现在我们突然又允许一个d 跟它重叠，结果就是cccAdw , d和w 之间的距离几乎为零，导致电荷排斥力和范德华力等，都没有任何意义的大，第一窗口的d1 也就不准了。 d和 w 之间的问题被称为 end point catastrophe, 字面意思终点碰撞灾难。 为了解决这个问题，另一个虚拟的解决办法被引入，也就是在前几个窗口不去计算新出现的原子与环境的电荷势能，而只在后半程计算。</p>

<p>虽然仍然没有大规模普及，但是GPU技术的廉价话正让FEP的门槛迅速降低，比如32块CPU的计算速度为12小时，使用英伟达Tesla-V100-GPU可能只需要一小时，但计算成本可能是接近的。
目前做的最好的自由能微扰提供商是以量子力学科学巨人薛定谔命名的公司——薛定谔，Schrodinger 被认为是下一个特斯拉，比尔盖茨十多年前就已经开始对薛定谔投资。 薛定谔的FEP plus 现在是行业标准，其FEP正在深刻改变药物早期筛选的格局，各大顶级药企都是该公司客户。 免费的FEP可以通过伊利诺伊大学开发的NAMD或者斯德哥尔摩大学开发的Gromacs实现，需要学习代码操作。如果有钱，还是选择薛定谔，薛定谔提供全流程的图形界面操作。</p>

<p>对于有机化学的合成劳工们来说，一个好的FEP也许意味着可以省下几个月摇瓶子的时间。因为以前甚至是此时此刻，有机化学的从业者们仍然不得不一个一个的合成出氟/氯/溴取代的一系列化合物来做生物活性测试，也许以后只测其中一个，剩下的两个就可以通过FEP来评估是否还有合成的必要性，即如果FEP结果为负数可考虑合成，如果为正则可降低合成优先级。如果能避免接触有毒有害的试剂，避免分析那些烧脑的反应机理，就能达到目的，是所有人都乐见的。</p>

<p>下面具体阐述fep大的计算原理，如下所示，第一行路径的前半部分 >1> 和 第二条路径的后半部分 >4> 是真实的，这两个过程代表着分别将两个分子溶于水并与蛋白结合的过程；而第一行的后半部分 >2> 和第二行的前半部分是 >3> 则是假的，这两个过程分别代表了结合了蛋白的配体之间的lambda转化和单纯的配体之间的转化，这在现实中是无法操作的。两个类药分子对靶点蛋白结合自由能差异ΔΔG= 4-1 ， 因为1 是第一个分子的结合自由能，4 是第二个分子的结合自由能，即我们需要计算两个真实的结合自由能过程。</p>

<p>Acccc  >1>  Acccc + protein  >2>  Adddd + protein</p>

<p>Acccc  >3>  Adddd  >4>  Adddd + protein</p>

<p>但是在实际计算中无论是计算1还是计算4 都是十分困难的，由于体系里突然多出一个蛋白质，即使使用超级计算机也难以使得使得模拟体系平衡. 由于起始点和结束点相同，我们可以得到1+2 = 3+4， 移项，就有4-1= 2-3， 而2 和3 所连接的体系差别很小，因此在fep计算中就只需要分别计算2和3，然后做差即可。</p>

<p>由于这种计算是基于虚拟的转变，因此fep 也被称为“炼金术化学”，即通过原子种类的直接改变实现化学转变（现代化学只能实现原子的排列组合而无法直接改变类型），也通过现实中不会发生的能量过程实现状态转变，就像古代炼制丹药的人一样。</p>

下图进一步解释了这个原理，横向为真实的，但是难于计算的自由能，竖向为虚假但是容易计算的自由能。

<a href="#">
            <img class="img-fluid" src="img/fep-path.png" alt="">
            </a>

<p>现在我们假设四个图中的左上为起始点，右下为结束点，从起始点到结束点沿着箭头方向有两个路径，其自由能变化理论上是绝对一样的，那么很容易就得到
ΔGsolvent+ ΔGxld = ΔGxlc+ΔGcomplex, 现在移项得到：
ΔGxld – ΔGxlc = ΔGcomplex-ΔGsolvent, 而这个差值正是我们需要的ΔΔG，同时注意到与横向计算不同，ΔGcomplex-ΔGsolvent 是竖直计算的，由上图，竖直相邻的两个体系差别很小，因此相对容易达到平衡，在实际计算的时候，就容易实现。因此只需分别计算ΔGcomplex和 ΔGsolvent，然后对二者做差，就是ΔΔG。</p>

        </div>
      </div>
    </div>
  </article>

  <hr>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <ul class="list-inline text-center">
            <li class="list-inline-item">
              <a href="#">
                <span class="fa-stack fa-lg">
                 
                </span>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="#">
                <span class="fa-stack fa-lg">
                
                </span>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="#">
                <span class="fa-stack fa-lg">
                 
                </span>
              </a>
            </li>
          </ul>
          <p class="copyright text-muted">Copyright &copy; https://quantaosun.github.io 2020</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Custom scripts for this template -->
  <script src="js/clean-blog.min.js"></script>

</body>
  <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-analytics.js"></script>

<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyAwvMKIl51VOL3ylhhabX8W0Bg2jh1X7cA",
    authDomain: "my-phd-poject.firebaseapp.com",
    projectId: "my-phd-poject",
    storageBucket: "my-phd-poject.appspot.com",
    messagingSenderId: "321644397346",
    appId: "1:321644397346:web:c592da4a8401be71e6db7b",
    measurementId: "G-Z5EPP38GP0"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
</script>

</html>
